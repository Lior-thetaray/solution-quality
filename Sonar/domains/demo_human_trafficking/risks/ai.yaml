identifier: demo_human_trafficking
display_name: demo_human_trafficking display_name
description: demo_human_trafficking description
category: ai
severity: 90
analysis_method: 'AI'
read_only: True
dynamic_display_name: "{{ algo[0].display_name }} | {{ algo[1].display_name }}"
dynamic_description: "{{ algo[0].description }}. {{ algo[1].description }}"
dynamic_category: "{{ algo[0].category }}"
dynamic_severity: "{{ 1 + activity.algo_score * 99 }}"
dynamic_suppression_identifier: "{{ activity.algo_pattern }}"
suppression_period_unit: DAY
suppression_period_size: -1
evaluation_flows:
  - demo_human_trafficking_ef
parameters:
  - name: threshold_algo
    datatype: DOUBLE
    value: '0.5'
  - name: name
    datatype: STRING
    value: 'ANOM001'
  - name: date
    datatype: STRING
    value: '2025-01'
variables:
  - name: is_anomaly
    display_name: is_anomaly
    description: "is_anomaly"
    expression: "(activity.algo_score > {parameters.threshold_algo}) AND (activity.customer_id = {parameters.name}) AND (activity.year_month_str >= {parameters.date})"
    datatype: BOOLEAN
  - name: pattern
    display_name: pattern
    description: pattern creator
    expression: "activity.algo_pattern"
    datatype: STRING
conditions:
  - variable: is_anomaly
    value: "true"
    display_settings:
      - type: "Rating"
        evaluation_step: "algo"